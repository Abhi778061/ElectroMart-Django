{% extends 'base.html' %}
{% block content %}

<style>
/* ================= ANIMATION ================= */
.fade-in {
  animation: fadeUp 0.45s ease-in-out;
}
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ================= CART CARD ================= */
.cart-card {
  border-radius: 14px;
  transition: 0.25s ease;
}
.cart-card:hover {
  box-shadow: 0 12px 30px rgba(0,0,0,0.08);
}

/* ================= QTY ================= */
.qty-input {
  width: 65px;
  text-align: center;
}

/* ================= PRICE BOX ================= */
.price-box {
  position: sticky;
  top: 90px;
}

/* ================= EMPTY CART ================= */
.empty-cart {
  min-height: 65vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
.empty-icon {
  font-size: 90px;
  animation: bounce 1.6s infinite;
}
@keyframes bounce {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-12px); }
}
/* ðŸ›’ Cart item animation */
.cart-card {
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  cursor: pointer;
}

/* Hover / touch effect */
.cart-card:hover {
  transform: translateY(-4px) scale(1.01);
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
}

/* Click / tap animation */
.cart-card:active {
  transform: scale(0.98);
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
}
</style>

<div class="container my-5 fade-in">

{% if items %}

<div class="row g-4">

  <!-- ================= LEFT ================= -->
  <div class="col-lg-8">

    <h4 class="fw-bold mb-3">ðŸ›’ My Cart ({{ items|length }} item{{ items|pluralize }})</h4>

    {% for item in items %}
    <div class="card cart-card border-0 shadow-sm mb-4">
      <div class="card-body d-flex gap-3">

        <!-- IMAGE -->
        <img src="{{ item.product.image.url }}"
             width="110" height="110"
             class="rounded"
             style="object-fit:cover;">

        <!-- DETAILS -->
        <div class="flex-grow-1">

          <h6 class="fw-semibold mb-1">{{ item.product.name }}</h6>

          <!-- RATING LOOK -->
          <div class="small text-warning mb-1">
            â˜…â˜…â˜…â˜…â˜† <span class="text-muted">(2,300)</span>
          </div>

          <p class="fw-bold mb-1">
            â‚¹{{ item.product.price }}
            <span class="text-muted small text-decoration-line-through ms-1">
              â‚¹{{ item.product.price|add:2000 }}
            </span>
            <span class="text-success small ms-1">20% OFF</span>
          </p>

          <p class="small text-success mb-2">
            âœ” In stock Â· Free delivery by <b>Tomorrow</b>
          </p>

          <!-- QTY + REMOVE -->
          <div class="d-flex align-items-center gap-3">

            <form method="POST" action="{% url 'update_quantity' item.id %}">
              {% csrf_token %}
              <input type="number"
                     name="quantity"
                     value="{{ item.quantity }}"
                     min="1"
                     class="form-control form-control-sm qty-input"
                     onchange="this.form.submit()">
            </form>

            <a href="{% url 'remove_from_cart' item.id %}"
               class="btn btn-sm btn-outline-danger">
              Remove
            </a>

          </div>
        </div>

        <!-- TOTAL PRICE -->
        <div class="text-end fw-bold fs-6">
          â‚¹{{ item.total_price }}
        </div>

      </div>
    </div>
    {% endfor %}

  </div>

  <!-- ================= RIGHT ================= -->
  <div class="col-lg-4">
    <div class="card price-box border-0 shadow-sm p-4">

      <h5 class="fw-bold mb-3">Price Details</h5>

      <div class="d-flex justify-content-between mb-2">
        <span>Items Price</span>
        <span>â‚¹{{ total }}</span>
      </div>

      <div class="d-flex justify-content-between mb-2">
        <span>Delivery Charges</span>
        <span class="text-success">FREE</span>
      </div>

      <hr>

      <div class="d-flex justify-content-between fw-bold fs-5 mb-3">
        <span>Total Payable</span>
        <span>â‚¹{{ total }}</span>
      </div>

      <a href="{% url 'checkout' %}"
         class="btn btn-success w-100 py-2 fw-semibold">
        Proceed to Secure Checkout
      </a>

      <p class="text-center text-muted small mt-3">
        ðŸ”’ 100% Secure Payments Â· Easy Returns
      </p>
    </div>
  </div>

</div>

{% else %}

<!-- ================= EMPTY CART (UNCHANGED) ================= -->
<div class="empty-cart">
  <div class="text-center">
    <div class="empty-icon mb-3">ðŸ›’</div>
    <h2 class="fw-bold">Your Cart is Empty</h2>
    <p class="text-muted mb-4">
      Add items to your cart to see them here.
    </p>
    <a href="{% url 'home' %}" class="btn btn-primary px-5 py-2">
      Start Shopping
    </a>
  </div>
</div>

{% endif %}

</div>

{% endblock %}